<%- model_class = Order -%>
<div class="page-header">
  <h1>Cart</h1>
</div>
<table class="table table-striped">
  <thead>
    <tr>
      <th>Picture</th>
      <th>Name</th>
      <th>Price</th>
      <th>Amount</th>
      <th>Subtotal</th>
    </tr>
  </thead>
  <tbody>
    <% if @orders.count == 0 %>
      <tr>
        <td colspan="5">Cart is empty.</td>
      </tr>
    <% else
         total = 0
         @orders.each do |order| %>
      <tr>
        <td><%= link_to image_tag(order.product.picture_path, style: "max-height: 64px"), product_path(order.product) %></td>
        <td><%= order.product.name %><small><%= order.product.code %></small></td>
        <td><%= order.product.price %></td>
        <td><%= order.amount %></td>
        <td><%= order.product.price * order.amount %></td>
        <% total += order.product.price * order.amount %>
      </tr>
      <% end
       end %>
    <tr>
      <th colspan="4" style="text-aling: right">Total:</td>
      <td><%= total %></td>
    </tr>
  </tbody>
</table>

<% if @orders.count == 0 %>
  <button class="btn btn-primary" disabled="disabled">Proceed to checkout</button>
<% else %>
  <%= link_to 'Proceed to checkout', orders_checkout_path, class: 'btn btn-primary' %>
<% end %>
